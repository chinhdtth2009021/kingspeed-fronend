{"ast":null,"code":"var _jsxFileName = \"D:\\\\visuacode\\\\code-kingspeed\\\\kingspeed\\\\src\\\\features\\\\MyLockedItem.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { Button, Link } from \"@chakra-ui/react\";\nimport { numberFormat } from \"../utils/MathCommon\";\nimport { Box, Flex, Tr, Td, Image, Popover, PopoverTrigger, PopoverContent, PopoverHeader, PopoverBody, PopoverArrow, PopoverCloseButton } from '@chakra-ui/react';\nimport PackgeData from '../_mocks_/PackageData';\nimport dayjs from \"dayjs\";\nimport { findPackageByAmount, parseBalance } from \"../utils/Helper\";\nimport StakingContract from '../contracts/KingSpeedStakingContac.json';\nimport { formatDateYYYYMMDDHHMMSS } from \"../utils/DateFormat\";\nimport { useAppDispatch, useAppSelector } from \"../app/hooks\";\nimport { selectAccount, setIsLoading } from \"../reducers\";\nimport { notification } from \"../utils/Notification\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BSC_SCAN_HASH_URL = 'https://testnet.bscscan.com/tx/';\nexport default function MyLocKedItem(_ref) {\n  _s();\n\n  let {\n    stake,\n    updateStaked\n  } = _ref;\n  console.log(\"stake\", stake);\n  const dispath = useAppDispatch();\n  const {\n    web3,\n    walletAddress,\n    isLoading\n  } = useAppSelector(selectAccount);\n  const [transactionInfo, setTranssactionInfo] = useState({\n    transactionHash: '',\n    isOpen: false\n  });\n  const stakedAmount = parseBalance(stake.amount);\n  const optionName = stake.termOption;\n  const endDate = formatDateYYYYMMDDHHMMSS(dayjs.unix(parseFloat(stake.releaseDate)).toDate());\n  const stakeDate = formatDateYYYYMMDDHHMMSS(dayjs.unix(parseFloat(stake.releaseDate) - parseInt(optionName) * 24 * 3600).toDate());\n  const isClaim = dayjs(new Date()).unix() >= parseFloat(stake.releaseDate);\n  const rewardDebt = parseBalance(stake.rewardDebt);\n  const accueDays = dayjs(new Date()).diff(stakeDate, 'days');\n  const foundPakageId = findPackageByAmount(stakedAmount);\n  const foundPakage = PackgeData.find(pack => pack.id === foundPakageId);\n  const foundOption = foundPakage.options.find(option => option.duration === parseInt(optionName));\n\n  const handleClain = async () => {\n    dispath(setIsLoading(true));\n\n    try {\n      const stakingContract = new web3.eth.Contract(StakingContract.abi, // process.env.REACT_APP_-STAKING_CONTRACT\n      process.env.REACT_APP_STAKING_CONTRACT);\n      await stakingContract.methods.unStake(stake.indexStake).send({\n        from: walletAddress\n      }).on('receipt', async receipt => {\n        if (receipt.status) {\n          setTranssactionInfo({\n            transactionHash: receipt === null || receipt === void 0 ? void 0 : receipt.transactionHash,\n            isOpen: true\n          });\n          notification('Withdraw amount stake successfully.', 'success');\n          updateStaked(stake.indexStake);\n        } else {\n          if (receipt !== null && receipt !== void 0 && receipt.transactionHash) {\n            setTranssactionInfo({\n              transactionHash: receipt === null || receipt === void 0 ? void 0 : receipt.transactionHash,\n              isOpen: true\n            });\n          }\n\n          notification('Withdraw amount stake fail.', \"error\");\n        }\n\n        dispath(setIsLoading(false));\n      }).on('error', function (error, receipt) {\n        if (receipt !== null && receipt !== void 0 && receipt.transactionHash) {\n          setTranssactionInfo({\n            transactionHash: receipt === null || receipt === void 0 ? void 0 : receipt.transactionHash,\n            isOpen: true\n          });\n        }\n\n        notification('Withdraw amount stake fail.', 'error');\n        dispath(setIsLoading(false));\n      });\n    } catch (error) {\n      dispath(setIsLoading(false));\n    }\n  };\n\n  const shortTransactionHash = hash => {\n    return hash ? `${hash === null || hash === void 0 ? void 0 : hash.substr(0, 6)}...${hash === null || hash === void 0 ? void 0 : hash.substr(hash.length - 6, hash.length - 1)}` : '';\n  };\n\n  const closeHash = () => {\n    setTranssactionInfo({\n      transactionHash: '',\n      isOpen: false\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Tr, {\n    bgColor: \"#070e10\",\n    children: [/*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      bgColor: \"#070e10\",\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        alignItems: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Image, {\n          src: foundPakage.image,\n          alt: foundPakage.name,\n          h: \"17px\",\n          w: \"17px\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          fontSize: \"16px\",\n          fontWeight: \"600\",\n          textTransform: \"uppercase\",\n          ml: \"10px\",\n          children: foundPakage.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        fontSize: \"16px\",\n        children: [numberFormat(stakedAmount), \" KSC\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        color: \"#ffab00\",\n        fontSize: \"16px\",\n        fontWeight: \"600\",\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          children: [foundOption === null || foundOption === void 0 ? void 0 : foundOption.rate, \" %\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this), (foundOption === null || foundOption === void 0 ? void 0 : foundOption.gift) && /*#__PURE__*/_jsxDEV(Box, {\n          children: [\" \", foundOption.gift]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 35\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        fontSize: \"16px\",\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          children: stakeDate\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        fontSize: \"16px\",\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          children: `${optionName} days`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        fontSize: \"16px\",\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          children: endDate\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        ontSize: \"16px\",\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          children: [accueDays, \" days\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        color: \"#ffab00\",\n        fontSize: \"16px\",\n        fontWeight: \"600\",\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          children: [numberFormat(rewardDebt), \" KSC\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Td, {\n      borderBottom: \"8px solid #000000 !important\",\n      paddingLeft: \"10px\",\n      children: /*#__PURE__*/_jsxDEV(Popover, {\n        returnFocusOnClose: false,\n        isOpen: transactionInfo.isOpen,\n        onClose: closeHash,\n        placement: \"right\",\n        closeOnBlur: false,\n        children: [/*#__PURE__*/_jsxDEV(PopoverTrigger, {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            fontWeight: \"700\",\n            disabled: !isClaim || isLoading || stake.isStaked,\n            onClick: handleClain,\n            color: \"#000000\",\n            background: \"#ffab00\",\n            fontSize: \"15px\",\n            p: \"0 30px\",\n            _hover: {\n              color: '#000000',\n              background: '#ffab00'\n            },\n            isLoading: isLoading,\n            loadingText: \"Loading\",\n            children: \"Claim\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(PopoverContent, {\n          children: [/*#__PURE__*/_jsxDEV(PopoverHeader, {\n            fontWeight: \"semibold\",\n            children: \"Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(PopoverArrow, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(PopoverCloseButton, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(PopoverBody, {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              href: `${BSC_SCAN_HASH_URL}${transactionInfo.transactionHash}`,\n              isExternal: true,\n              children: [\"View transaction on BSCScan:\", ' ', `${shortTransactionHash(transactionInfo.transactionHash)}`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 1\n  }, this);\n}\n\n_s(MyLocKedItem, \"SH9KpZlopb6Rh/eMHKgSd2b9sE8=\", false, function () {\n  return [useAppDispatch, useAppSelector];\n});\n\n_c = MyLocKedItem;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyLocKedItem\");","map":{"version":3,"sources":["D:/visuacode/code-kingspeed/kingspeed/src/features/MyLockedItem.tsx"],"names":["React","useState","Button","Link","numberFormat","Box","Flex","Tr","Td","Image","Popover","PopoverTrigger","PopoverContent","PopoverHeader","PopoverBody","PopoverArrow","PopoverCloseButton","PackgeData","dayjs","findPackageByAmount","parseBalance","StakingContract","formatDateYYYYMMDDHHMMSS","useAppDispatch","useAppSelector","selectAccount","setIsLoading","notification","BSC_SCAN_HASH_URL","MyLocKedItem","stake","updateStaked","console","log","dispath","web3","walletAddress","isLoading","transactionInfo","setTranssactionInfo","transactionHash","isOpen","stakedAmount","amount","optionName","termOption","endDate","unix","parseFloat","releaseDate","toDate","stakeDate","parseInt","isClaim","Date","rewardDebt","accueDays","diff","foundPakageId","foundPakage","find","pack","id","foundOption","options","option","duration","handleClain","stakingContract","eth","Contract","abi","process","env","REACT_APP_STAKING_CONTRACT","methods","unStake","indexStake","send","from","on","receipt","status","error","shortTransactionHash","hash","substr","length","closeHash","image","name","rate","gift","isStaked","color","background"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport { Button, Link } from \"@chakra-ui/react\";\r\nimport { numberFormat } from \"../utils/MathCommon\";\r\nimport {\r\n    Box, Flex, Tr, Td, Image, Popover, PopoverTrigger, PopoverContent, PopoverHeader, PopoverBody, PopoverArrow, PopoverCloseButton\r\n} from '@chakra-ui/react'\r\nimport PackgeData from '../_mocks_/PackageData'\r\nimport dayjs from \"dayjs\";\r\nimport { findPackageByAmount, parseBalance } from \"../utils/Helper\";\r\nimport StakingContract from '../contracts/KingSpeedStakingContac.json'\r\nimport { formatDateYYYYMMDDHHMMSS } from \"../utils/DateFormat\";\r\nimport { useAppDispatch, useAppSelector } from \"../app/hooks\";\r\nimport { selectAccount, setIsLoading } from \"../reducers\";\r\nimport { AbiItem } from \"web3-utils\";\r\nimport { notification } from \"../utils/Notification\";\r\n\r\nconst BSC_SCAN_HASH_URL = 'https://testnet.bscscan.com/tx/'\r\nexport default function MyLocKedItem ({ stake, updateStaked }: any){\r\n    console.log(\"stake\", stake)\r\n    const dispath = useAppDispatch()\r\n    const { web3,walletAddress, isLoading} = useAppSelector(selectAccount)\r\n    const [ transactionInfo, setTranssactionInfo ] = useState ({\r\n        transactionHash: '',\r\n        isOpen: false,\r\n    })\r\n    const stakedAmount = parseBalance(stake.amount)\r\n    const optionName = stake.termOption\r\n    const endDate = formatDateYYYYMMDDHHMMSS(dayjs.unix(parseFloat(stake.releaseDate)).toDate())\r\n    const stakeDate = formatDateYYYYMMDDHHMMSS(\r\n        dayjs.unix(parseFloat(stake.releaseDate) - parseInt(optionName) * 24 * 3600).toDate()\r\n    )\r\nconst isClaim = dayjs(new Date()).unix() >= parseFloat(stake.releaseDate)\r\nconst rewardDebt = parseBalance(stake.rewardDebt)\r\nconst accueDays = dayjs (new Date()).diff(stakeDate, 'days')\r\nconst foundPakageId = findPackageByAmount(stakedAmount)\r\nconst foundPakage = PackgeData.find((pack) =>  pack.id === foundPakageId)!\r\nconst foundOption = foundPakage.options.find(\r\n    (option) => option.duration === parseInt(optionName)\r\n)!\r\nconst handleClain = async () => {\r\n    dispath(setIsLoading(true))\r\n    try {\r\n        const stakingContract = new web3.eth.Contract(\r\n            StakingContract.abi as AbiItem[],\r\n            // process.env.REACT_APP_-STAKING_CONTRACT\r\n            process.env.REACT_APP_STAKING_CONTRACT\r\n        )\r\n        await stakingContract.methods.unStake(stake.indexStake).send({ from: walletAddress }).on('receipt', async ( receipt: any) => {\r\n            if (receipt.status) {\r\n                setTranssactionInfo({\r\n                    transactionHash: receipt?.transactionHash,\r\n                    isOpen: true,\r\n                })\r\n                notification('Withdraw amount stake successfully.', 'success')\r\n                updateStaked(stake.indexStake)\r\n            } else {\r\n                if (receipt?.transactionHash) {\r\n                    setTranssactionInfo({\r\n                        transactionHash: receipt?.transactionHash,\r\n                        isOpen: true\r\n                    })\r\n                }\r\n                notification('Withdraw amount stake fail.', \"error\")\r\n            }\r\n\r\n            dispath(setIsLoading(false))\r\n        })\r\n        .on('error', function (error: any, receipt: any) {\r\n            if (receipt?.transactionHash) {\r\n                setTranssactionInfo({ transactionHash: receipt?.transactionHash, isOpen: true })\r\n            }\r\n            notification('Withdraw amount stake fail.', 'error')\r\n            dispath(setIsLoading(false))\r\n        })\r\n} catch (error) {\r\n    dispath(setIsLoading(false))\r\n}\r\n}\r\n\r\nconst shortTransactionHash = (hash: string) => {\r\nreturn hash\r\n    ? `${hash?.substr(0, 6)}...${hash?.substr(hash.length - 6, hash.length - 1)}`\r\n    : ''\r\n}\r\n\r\nconst closeHash = () => {\r\nsetTranssactionInfo({\r\n    transactionHash: '',\r\n    isOpen: false,\r\n})\r\n}\r\n\r\nreturn (\r\n<Tr bgColor=\"#070e10\">\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\" bgColor=\"#070e10\">\r\n        <Flex alignItems=\"center\">\r\n            <Image src={foundPakage.image} alt={foundPakage.name} h=\"17px\" w=\"17px\" />\r\n            <Box fontSize=\"16px\" fontWeight=\"600\" textTransform=\"uppercase\" ml=\"10px\">\r\n                {foundPakage.name}\r\n            </Box>\r\n        </Flex>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Box fontSize=\"16px\">{numberFormat(stakedAmount)} KSC</Box>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Box color=\"#ffab00\" fontSize=\"16px\" fontWeight=\"600\">\r\n            <Box>{foundOption?.rate} %</Box>\r\n            {foundOption?.gift && <Box> {foundOption.gift}</Box>}\r\n        </Box>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Box fontSize=\"16px\">\r\n            <Box>{stakeDate}</Box>\r\n        </Box>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Box fontSize=\"16px\">\r\n            <Box>{`${optionName} days`}</Box>\r\n        </Box>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Box fontSize=\"16px\">\r\n            <Box>{endDate}</Box>\r\n        </Box>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Box ontSize=\"16px\">\r\n            <Box>{accueDays} days</Box>\r\n        </Box>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Box color=\"#ffab00\" fontSize=\"16px\" fontWeight=\"600\">\r\n            <Box>{numberFormat(rewardDebt)} KSC</Box>\r\n        </Box>\r\n    </Td>\r\n    <Td borderBottom=\"8px solid #000000 !important\" paddingLeft=\"10px\">\r\n        <Popover\r\n            returnFocusOnClose={false}\r\n            isOpen={transactionInfo.isOpen}\r\n            onClose={closeHash}\r\n            placement=\"right\"\r\n            closeOnBlur={false}\r\n        >\r\n            <PopoverTrigger>\r\n                <Button\r\n                    fontWeight=\"700\"\r\n                    disabled={!isClaim || isLoading || stake.isStaked}\r\n                    onClick={handleClain}\r\n                    color=\"#000000\"\r\n                    background=\"#ffab00\"\r\n                    fontSize=\"15px\"\r\n                    p=\"0 30px\"\r\n                    _hover={{\r\n                        color: '#000000',\r\n                        background: '#ffab00',\r\n                    }}\r\n                    isLoading={isLoading}\r\n                    loadingText=\"Loading\"\r\n                >\r\n                    Claim\r\n                </Button>\r\n            </PopoverTrigger>\r\n\r\n            <PopoverContent>\r\n                <PopoverHeader fontWeight=\"semibold\">Information</PopoverHeader>\r\n                <PopoverArrow />\r\n                <PopoverCloseButton />\r\n                <PopoverBody>\r\n                    <Link\r\n                        href={`${BSC_SCAN_HASH_URL}${transactionInfo.transactionHash}`}\r\n                        isExternal\r\n                    >\r\n                        View transaction on BSCScan:{' '}\r\n                        {`${shortTransactionHash(transactionInfo.transactionHash)}`}\r\n                    </Link>\r\n                </PopoverBody>\r\n            </PopoverContent>\r\n        </Popover>\r\n    </Td>\r\n</Tr>\r\n)\r\n}"]},"metadata":{},"sourceType":"module"}